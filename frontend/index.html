<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="style.css" rel="stylesheet"/>
    <link href="node_modules/leaflet/dist/leaflet.css"
          rel="stylesheet"/>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="node_modules/leaflet/dist/leaflet.js"></script>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Marker Cluster CSS and JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
    <title>Walkscapes</title>
</head>

<body>
<h1>Walkscapes</h1>
<div id="map" style="width: 100%; height: 80%;"></div>
<script src="getDataFromDB.js"></script>
<script src="additional.js"></script>
<script src="map.js"></script>
<script src="uploadRecord.js"></script>
<script src="suggestions.js"></script>
<script src="main.js"></script>

<div id="overlay">
    <div id="popup">
        <h2>Upload Image</h2>
        <form id="uploadForm">
            <h3 for="images">Choose Image:</h3>
            <input accept="image/*" id="images" multiple name="image" required type="file">
            <!-- Display uploaded images -->
            <div id="uploadedImages">
                <h3>Uploaded Images:</h3>
                <ul id="imageList" class="list"></ul>
            </div>
         
            <h3 for="description">Description:</h3>
            <textarea id="description" name="description" required rows="4"></textarea>
            <br>
            <!-- <button class="popup-button" onclick="uploadRecord(coordsForUploading[0], coordsForUploading[1])" type="submit">Upload</button> -->
            <!-- <button class="popup-button" onclick="togglePopup()" type="button">Close</button> -->
            <button id="submit" class="popup-button" onclick="submitButtonClicked()" type="submit">Submit</button>
            <button id="close" class="popup-button" onclick="closeButtonClicked()" type="button">Close</button>
        
            
        </form>
    </div>
</div>


<script type="module">
    updateImageList();
    // Open suggestions.html and pass the overlay reference
    /*function closeButtonClicked(){
        submitted = false;
        togglePopup();
    }

    function submitButtonClicked(){
        submitted = true;
        uploadRecord(coordsForUploading[0], coordsForUploading[1])
    }
*/



    document.getElementById('uploadForm').addEventListener('submit', function (e) {
        e.preventDefault();
        togglePopup();
    });  

    //let imageList = []; // Store selected files here

    /*function updateImageList() {
        const imageListContainer = document.getElementById('imageList');
        //imageListContainer.innerHTML = ""; // Clear the list

        const newImages = document.getElementById('images').files;

        for (let i = 0; i < newImages.length; i++) {
            const li = document.createElement('li');
            const deleteButton = document.createElement('button');

            li.textContent = newImages[i].name;

            // Use a closure to capture the correct index for each delete button
            (function(index) {
                deleteButton.textContent = 'Delete';
                deleteButton.addEventListener('click', function() {
                    // Call a function to handle image deletion
                    deleteImage(index);
                });
            })(i);
            li.appendChild(deleteButton);
            imageListContainer.appendChild(li);
        }
        
        console.log(imageListContainer);
        // Update the global variable with the selected files
        imageList = Array.from(newImages);

        console.log(imageList);
    }

    function deleteImage(index) {
        // Remove the image at the specified index
        const imageListContainer = document.getElementById('imageList');
        imageListContainer.removeChild(imageListContainer.children[index]);

        // Update the list of uploaded images
        //updateImageList();
    }*/

    document.getElementById('images').addEventListener('change', updateImageList);

</script>

<br>
</body>
</html>
